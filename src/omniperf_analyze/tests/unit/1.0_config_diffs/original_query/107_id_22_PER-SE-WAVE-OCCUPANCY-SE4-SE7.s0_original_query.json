[
    {"$group": {
        "_id": null,
        "timeSum": {
            "$sum": { "$subtract": ["&EndTime", "&BeginTime"] }
        },
        "maxEnd": {
          "$max": "&EndTime"
        },
        "minBegin": {
          "$min": "&BeginTime"
        }
    }},
    {"$project": {
      "_id": 0,
      "Shader Engine": "SE4",
      "Avg Wave Occupancy": {
        "$divide": ["&timeSum", { "$subtract": ["&maxEnd", "&minBegin"] }]
      }
    }},
    {"$unionWith": {
      "coll": "wave_timing_se5",
      "pipeline": [
        {"$group": {
            "_id": null,
            "timeSum": {
                "$sum": { "$subtract": ["&EndTime", "&BeginTime"] }
            },
            "maxEnd": {
              "$max": "&EndTime"
            },
            "minBegin": {
              "$min": "&BeginTime"
            }
        }},
        {"$project": {
          "_id": 0,
          "Shader Engine": "SE5",
          "Avg Wave Occupancy": {
            "$divide": ["&timeSum", { "$subtract": ["&maxEnd", "&minBegin"] }]
          }
        }}
      ]
    }},
    {"$unionWith": {
      "coll": "wave_timing_se6",
      "pipeline": [
        {"$group": {
            "_id": null,
            "timeSum": {
                "$sum": { "$subtract": ["&EndTime", "&BeginTime"] }
            },
            "maxEnd": {
              "$max": "&EndTime"
            },
            "minBegin": {
              "$min": "&BeginTime"
            }
        }},
        {"$project": {
          "_id": 0,
          "Shader Engine": "SE6",
          "Avg Wave Occupancy": {
            "$divide": ["&timeSum", { "$subtract": ["&maxEnd", "&minBegin"] }]
          }
        }}
      ]
    }},
    {"$unionWith": {
      "coll": "wave_timing_se7",
      "pipeline": [
        {"$group": {
            "_id": null,
            "timeSum": {
                "$sum": { "$subtract": ["&EndTime", "&BeginTime"] }
            },
            "maxEnd": {
              "$max": "&EndTime"
            },
            "minBegin": {
              "$min": "&BeginTime"
            }
        }},
        {"$project": {
          "_id": 0,
          "Shader Engine": "SE7",
          "Avg Wave Occupancy": {
            "$divide": ["&timeSum", { "$subtract": ["&maxEnd", "&minBegin"] }]
          }
        }}
      ]
    }}
]